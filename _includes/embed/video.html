<div class="video-container">
  <video controls playsinline preload="metadata" muted class="auto-play-video">
    <source src="{{ include.src }}#t=0.1" type="video/mp4">
    Your browser does not support the video tag.
  </video>
</div>

<script>
(function() {
  const videos = document.querySelectorAll('.auto-play-video');

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      const video = entry.target;
      if (entry.isIntersecting && entry.intersectionRatio >= 0.5) {
        video.play().catch(() => {});
      } else {
        video.pause();
      }
    });
  }, { threshold: 0.5 });

  videos.forEach(video => {
    observer.observe(video);
    video.addEventListener('click', () => {
      video.muted = !video.muted;
    });
  });
})();
</script>
