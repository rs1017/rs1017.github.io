---
layout: post
title: "XLSX - 스프레드시트 생성/편집/분석 스킬"
date: 2026-01-23 10:14:00 +0900
categories: [AI, Skill]
tags: [claude-code, skill, xlsx, excel, spreadsheet]
---

## 개요

XLSX는 수식, 서식, 데이터 분석, 시각화를 지원하는 종합 스프레드시트 생성, 편집, 분석 스킬입니다. .xlsx, .xlsm, .csv, .tsv 등을 지원합니다.

## 출력 요구사항

### 모든 Excel 파일

- **수식 오류 제로**: #REF!, #DIV/0!, #VALUE!, #N/A, #NAME? 없어야 함
- **기존 템플릿 보존**: 수정 시 기존 형식, 스타일, 관례 정확히 일치

### 재무 모델 색상 코딩

| 색상 | RGB | 용도 |
|------|-----|------|
| 파란색 텍스트 | 0,0,255 | 하드코딩된 입력 |
| 검정색 텍스트 | 0,0,0 | 모든 수식과 계산 |
| 초록색 텍스트 | 0,128,0 | 같은 워크북 내 다른 시트 링크 |
| 빨간색 텍스트 | 255,0,0 | 외부 파일 링크 |
| 노란색 배경 | 255,255,0 | 주의 필요한 가정 |

## 핵심 원칙: 수식 사용

```python
# 잘못된 방법 - 하드코딩
total = df['Sales'].sum()
sheet['B10'] = total  # 5000 하드코딩

# 올바른 방법 - Excel 수식
sheet['B10'] = '=SUM(B2:B9)'
```

## 공통 워크플로우

1. **도구 선택**: 데이터용 pandas, 수식/서식용 openpyxl
2. **생성/로드**: 새 워크북 생성 또는 기존 파일 로드
3. **수정**: 데이터, 수식, 서식 추가/편집
4. **저장**: 파일에 쓰기
5. **수식 재계산** (필수): `python recalc.py output.xlsx`
6. **오류 확인 및 수정**

## 새 Excel 파일 생성

```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill

wb = Workbook()
sheet = wb.active

sheet['A1'] = 'Hello'
sheet['B2'] = '=SUM(A1:A10)'  # 수식 사용
sheet['A1'].font = Font(bold=True, color='FF0000')

wb.save('output.xlsx')
```

## 수식 재계산

```bash
python recalc.py <excel_file> [timeout_seconds]
```

스크립트 동작:
- LibreOffice 매크로 자동 설정
- 모든 시트의 수식 재계산
- Excel 오류 스캔 및 JSON 반환

## 첨부 파일

> [xlsx SKILL.md](/assets/downloads/skills/xlsx/SKILL.md)

## 관련 스킬

- [docx](/posts/docx/) - Word 문서 작업
- [pdf](/posts/pdf/) - PDF 처리
- [pptx](/posts/pptx/) - 프레젠테이션 작업
